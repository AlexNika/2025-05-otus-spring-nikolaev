package ru.pricat.service;

/**
 * Интерфейс сервиса для отслеживания попыток аутентификации пользователя.
 * Используется для реализации механизма блокировки пользователя на определенное время
 * после превышения допустимого количества неудачных попыток входа.
 */
public interface LoginAttemptService {

    /**
     * Проверяет, заблокирован ли пользователь из-за превышения лимита неудачных попыток входа.
     *
     * @param username имя пользователя
     * @return true, если пользователь заблокирован, иначе false
     */
    boolean isBlocked(String username);

    /**
     * Регистрирует неудачную попытку входа для указанного пользователя.
     * Увеличивает счётчик попыток для этого пользователя.
     *
     * @param username имя пользователя, для которого зафиксирована неудачная попытка
     */
    void loginFailed(String username);

    /**
     * Регистрирует успешную попытку входа для указанного пользователя.
     * Сбрасывает счётчик попыток для этого пользователя.
     *
     * @param username имя пользователя, для которого зафиксирован успешный вход
     */
    void loginSucceeded(String username);
}
